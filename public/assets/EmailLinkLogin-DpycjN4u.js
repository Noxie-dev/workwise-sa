import{j as e}from"./vendor-ui-s4VaHhe3.js";import{b as n}from"./vendor-react-BLR_YkO_.js";import{H as b}from"./Helmet-0wtNoWcg.js";import{u as w,L as d}from"./vendor-router-B3zuYAIM.js";import{t as k,F as N,a as v,b as S,c as F,d as L,e as C}from"./form-DscTub4z.js";import{u as E,z as m}from"./vendor-forms-BbWomOe6.js";import{C as P,b as A,c as W,d as G,a as I,e as T}from"./card-8UZPBAHq.js";import{u as q,f as M,A as z,a as D,b as H,B as u,l as B,g as O}from"./index-9094wa89.js";import{I as R}from"./input-IlxudZmX.js";import{C as V}from"./vendor-icons-CgtSIdDt.js";import"./vendor-charts-CaNT0DhE.js";import"./label-Bf6ViPYU.js";import"./vendor-query-Cm3gWw8b.js";const J=m.object({email:m.string().email("Please enter a valid email address")}),re=()=>{const[r,i]=n.useState(!1),[h,p]=n.useState(!1),[x,g]=n.useState(""),{toast:l}=q(),[,c]=w(),{isAuthenticated:f}=M(),o=E({resolver:k(J),defaultValues:{email:""}});if(f)return c("/profile"),null;const j=async()=>{i(!0);try{await O(),c("/profile-setup")}catch(a){let s="Failed to sign in with Google. Please try again.";a.code==="auth/operation-not-allowed"?s="Google sign-in is not enabled. Please try another method or contact support.":a.code==="auth/popup-closed-by-user"?s="Sign-in popup was closed. Please try again.":a.code==="auth/cancelled-popup-request"?s="Multiple popup requests were made. Please try again.":a.code==="auth/popup-blocked"&&(s="Sign-in popup was blocked by your browser. Please allow popups for this site."),console.error("Google sign-in error:",a.code,a.message),l({variant:"destructive",title:"Login Failed",description:s})}finally{i(!1)}},y=async a=>{i(!0);try{await B(a.email),p(!0),g(a.email),l({title:"Email Sent",description:"A sign-in link has been sent to your email address."})}catch(s){let t="Failed to send sign-in link. Please try again.";s.code==="auth/invalid-email"?t="The email address is not valid.":s.code==="auth/network-request-failed"?t="Network error. Please check your internet connection.":s.code==="auth/operation-not-allowed"?t="Email link sign-in is not enabled. Please try another method or contact support.":s.code==="auth/unauthorized-domain"&&(t="This domain is not authorized for email link sign-in. Please try another method."),console.error("Email link error:",s.code,s.message),l({variant:"destructive",title:"Email Link Failed",description:t})}finally{i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx("title",{children:"Passwordless Login | WorkWise SA"}),e.jsx("meta",{name:"description",content:"Login to WorkWise SA with a secure email link - no password required!"})]}),e.jsx("main",{className:"flex-grow bg-light flex items-center justify-center py-10",children:e.jsxs(P,{className:"w-full max-w-md mx-4",children:[e.jsxs(A,{className:"space-y-1",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"/images/logo.png",alt:"WorkWise SA Logo",className:"h-36 md:h-40 object-contain transition-all duration-200 hover:scale-105"})}),e.jsx(W,{className:"text-2xl font-bold text-center",children:"Passwordless Login"}),e.jsx(G,{className:"text-center",children:"Get a secure sign-in link sent to your email"})]}),e.jsx(I,{children:h?e.jsxs(z,{className:"mb-4",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(D,{children:"Check your email"}),e.jsxs(H,{children:["We've sent a sign-in link to ",e.jsx("strong",{children:x}),". Click the link in the email to sign in to your account."]})]}):e.jsx(N,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(y),className:"space-y-4",children:[e.jsx(v,{control:o.control,name:"email",render:({field:a})=>e.jsxs(S,{children:[e.jsx(F,{children:"Email"}),e.jsx(L,{children:e.jsx(R,{type:"email",placeholder:"Enter your email",...a})}),e.jsx(C,{})]})}),e.jsx(u,{type:"submit",className:"w-full bg-primary",disabled:r,children:r?"Sending link...":"Send sign-in link"})]})})}),e.jsxs(T,{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-light px-2 text-muted",children:"Or continue with"})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(u,{variant:"outline",className:"w-full",onClick:j,disabled:r,children:[e.jsx("i",{className:"fab fa-google mr-2"})," Google"]})}),e.jsxs("p",{className:"text-center text-sm text-muted mt-4",children:["Want to use a password instead?"," ",e.jsx(d,{href:"/login",className:"text-primary hover:underline",children:"Password login"})]}),e.jsxs("p",{className:"text-center text-sm text-muted",children:["Don't have an account?"," ",e.jsx(d,{href:"/register",className:"text-primary hover:underline",children:"Sign up"})]})]})]})})]})};export{re as default};
