import{a as o,j as e}from"./vendor-BOJOR_z2.js";import{H as b}from"./Helmet-D3USV4CJ.js";import{a as w,u as k,g as N,A as v,b as S,c as F,L as d,v as L,h as C}from"./index-BYuk7_JU.js";import{t as E,F as P,a as A,b as W,c as G,d as I,e as T,z as m}from"./form-BHDrNC-d.js";import{u as q}from"./index.esm-CYlt0PPA.js";import{p as M,t as z,v as D,w as H,q as B,C as O,I as R,B as u,N as V}from"./contact-C28TQl3y.js";import"./index-PjsTQpNX.js";const J=m.object({email:m.string().email("Please enter a valid email address")}),$=()=>{const[r,i]=o.useState(!1),[h,p]=o.useState(!1),[x,g]=o.useState(""),{toast:l}=w(),[,c]=k(),{isAuthenticated:f}=N(),n=q({resolver:E(J),defaultValues:{email:""}});if(f)return c("/profile"),null;const j=async()=>{i(!0);try{await C(),c("/profile-setup")}catch(a){let s="Failed to sign in with Google. Please try again.";a.code==="auth/operation-not-allowed"?s="Google sign-in is not enabled. Please try another method or contact support.":a.code==="auth/popup-closed-by-user"?s="Sign-in popup was closed. Please try again.":a.code==="auth/cancelled-popup-request"?s="Multiple popup requests were made. Please try again.":a.code==="auth/popup-blocked"&&(s="Sign-in popup was blocked by your browser. Please allow popups for this site."),console.error("Google sign-in error:",a.code,a.message),l({variant:"destructive",title:"Login Failed",description:s})}finally{i(!1)}},y=async a=>{i(!0);try{await L(a.email),p(!0),g(a.email),l({title:"Email Sent",description:"A sign-in link has been sent to your email address."})}catch(s){let t="Failed to send sign-in link. Please try again.";s.code==="auth/invalid-email"?t="The email address is not valid.":s.code==="auth/network-request-failed"?t="Network error. Please check your internet connection.":s.code==="auth/operation-not-allowed"?t="Email link sign-in is not enabled. Please try another method or contact support.":s.code==="auth/unauthorized-domain"&&(t="This domain is not authorized for email link sign-in. Please try another method."),console.error("Email link error:",s.code,s.message),l({variant:"destructive",title:"Email Link Failed",description:t})}finally{i(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(b,{children:[e.jsx("title",{children:"Passwordless Login | WorkWise SA"}),e.jsx("meta",{name:"description",content:"Login to WorkWise SA with a secure email link - no password required!"})]}),e.jsx("main",{className:"flex-grow bg-light flex items-center justify-center py-10",children:e.jsxs(M,{className:"w-full max-w-md mx-4",children:[e.jsxs(z,{className:"space-y-1",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:"/images/logo.png",alt:"WorkWise SA Logo",className:"h-36 md:h-40 object-contain transition-all duration-200 hover:scale-105"})}),e.jsx(D,{className:"text-2xl font-bold text-center",children:"Passwordless Login"}),e.jsx(H,{className:"text-center",children:"Get a secure sign-in link sent to your email"})]}),e.jsx(B,{children:h?e.jsxs(v,{className:"mb-4",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx(S,{children:"Check your email"}),e.jsxs(F,{children:["We've sent a sign-in link to ",e.jsx("strong",{children:x}),". Click the link in the email to sign in to your account."]})]}):e.jsx(P,{...n,children:e.jsxs("form",{onSubmit:n.handleSubmit(y),className:"space-y-4",children:[e.jsx(A,{control:n.control,name:"email",render:({field:a})=>e.jsxs(W,{children:[e.jsx(G,{children:"Email"}),e.jsx(I,{children:e.jsx(R,{type:"email",placeholder:"Enter your email",...a})}),e.jsx(T,{})]})}),e.jsx(u,{type:"submit",className:"w-full bg-primary",disabled:r,children:r?"Sending link...":"Send sign-in link"})]})})}),e.jsxs(V,{className:"flex flex-col space-y-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-border"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-light px-2 text-muted",children:"Or continue with"})})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:e.jsxs(u,{variant:"outline",className:"w-full",onClick:j,disabled:r,children:[e.jsx("i",{className:"fab fa-google mr-2"})," Google"]})}),e.jsxs("p",{className:"text-center text-sm text-muted mt-4",children:["Want to use a password instead?"," ",e.jsx(d,{href:"/login",className:"text-primary hover:underline",children:"Password login"})]}),e.jsxs("p",{className:"text-center text-sm text-muted",children:["Don't have an account?"," ",e.jsx(d,{href:"/register",className:"text-primary hover:underline",children:"Sign up"})]})]})]})})]})};export{$ as default};
