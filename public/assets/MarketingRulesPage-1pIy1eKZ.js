import{f as ie,c as P,u as se,h as $,j as e,a as q,e as me}from"./vendor-BOJOR_z2.js";import{a as ce,u as ue,L as k}from"./index-BYuk7_JU.js";import{z as u,t as xe,F as he,a as R,b as C,c as T,d as L,e as F,f as V}from"./form-BHDrNC-d.js";import{p as j,t as b,v as y,B as I,ab as ge,q as v,ac as pe,ad as je,I as B,X as ve,Z as be,w as N,a0 as ye,ae as fe,af as we,ag as Ne,ah as ke,M as oe,ai as Ce,m as Te,k as Se,n as Ae,F as Re,S as Le,Y as De,aj as Pe,L as Ie}from"./contact-C28TQl3y.js";import{B as de}from"./badge-Dbv6MStK.js";import{T as Ee,a as Me,b as te,c as J,d as Fe,e as z}from"./table-DLw8QS_r.js";import{A as Je,a as ze,b as We,c as Ve,d as Ke,e as Oe,f as $e,g as qe}from"./alert-dialog-Dvsv8ooK.js";import{u as Be}from"./index.esm-CYlt0PPA.js";import{S as _,a as X,b as Z,c as ee,d as n}from"./select-DQ0ST6N3.js";import{S as Ge}from"./switch-gFn2Cl-f.js";import{T as He,a as Ue,b as G,c as H}from"./tabs-DPRANr_g.js";import{S as D}from"./skeleton-DTk9rcAT.js";import{R as U,T as Q,L as Qe,C as Ye,B as _e}from"./generateCategoricalChart-CvYaMm7S.js";import{L as Xe,a as ae}from"./LineChart-ZNKxPOLL.js";import{C as re,X as ne,Y as le,B as Ze}from"./BarChart-DPdmhglm.js";import{P as es,a as ss}from"./PieChart-BXcJGoK_.js";import"./index-DxgVd6xj.js";import"./index-BdQq_4o_.js";import"./index-B9Pj0zRd.js";import"./index-PjsTQpNX.js";const ts=u.object({id:u.string().optional(),ruleName:u.string().min(3,{message:"Rule name must be at least 3 characters"}),status:u.enum(["Active","Inactive"]),targetLocation:u.string(),targetJobType:u.string(),targetDemographics:u.string().optional(),demographicTags:u.array(u.string()).optional(),ctaPreview:u.string().optional(),messageTemplate:u.string().min(5,{message:"Message template must be at least 5 characters"}),ctaLink:u.string().url({message:"Must be a valid URL"}),createdAt:u.string().optional(),updatedAt:u.string().optional()});u.object({ruleId:u.string(),views:u.number(),clicks:u.number(),clickThroughRate:u.number(),trend:u.number()});const h=[{id:"1",ruleName:"Gauteng Jobs",status:"Active",targetLocation:"Gauteng",targetJobType:"All",ctaPreview:"Apply on WorkwiseSA for exclusive access!",messageTemplate:"Apply on WorkwiseSA for exclusive access!",ctaLink:"https://www.workwisesa.co.za/jobs/gauteng",createdAt:new Date(Date.now()-14*24*60*60*1e3).toISOString()},{id:"2",ruleName:"Security Jobs",status:"Active",targetLocation:"All",targetJobType:"Security",ctaPreview:"Click to view security clearance requirements",messageTemplate:"Click to view security clearance requirements",ctaLink:"https://www.workwisesa.co.za/jobs/security",createdAt:new Date(Date.now()-7*24*60*60*1e3).toISOString()},{id:"3",ruleName:"Retail Summer Campaign",status:"Active",targetLocation:"Cape Town",targetJobType:"Retail",ctaPreview:"Summer retail positions - Apply now!",messageTemplate:"Summer retail positions - Apply now!",ctaLink:"https://www.workwisesa.co.za/jobs/retail-summer",createdAt:new Date(Date.now()-3*24*60*60*1e3).toISOString()},{id:"4",ruleName:"Entry-level Tech Jobs",status:"Inactive",targetLocation:"All",targetJobType:"IT/Technology",targetDemographics:"Entry-level, No experience, Graduate, Junior",demographicTags:["Entry-level","No experience","Graduate","Junior"],ctaPreview:"No experience? No problem! Click to learn more",messageTemplate:"No experience? No problem! Click to learn more",ctaLink:"https://www.workwisesa.co.za/tech-careers",createdAt:new Date(Date.now()-1*24*60*60*1e3).toISOString()}],K=[{ruleId:"1",views:1500,clicks:320,clickThroughRate:21.3,trend:5.2},{ruleId:"2",views:1200,clicks:280,clickThroughRate:23.3,trend:2.1},{ruleId:"3",views:950,clicks:245,clickThroughRate:25.8,trend:8.7},{ruleId:"4",views:1071,clicks:264,clickThroughRate:24.6,trend:-1.3}],as={totalViews:4721,viewsChangePercent:12.5,totalClicks:1109,clicksChangePercent:8.3,clickThroughRate:23.5,ctrChangePercent:-2.1,performanceByRule:[{name:"Gauteng Jobs",clicks:320},{name:"Security Jobs",clicks:280},{name:"Retail Summer Campaign",clicks:245},{name:"Entry-level Tech Jobs",clicks:264}]},S={async getRules(){return Promise.resolve(h)},async getRule(t){return Promise.resolve(h.find(s=>s.id===t))},async createRule(t){const s={...t,id:Math.random().toString(36).substring(2,9),createdAt:new Date().toISOString(),ctaPreview:t.ctaPreview||t.messageTemplate};return h.push(s),Promise.resolve(s)},async updateRule(t,s){const r=h.findIndex(o=>o.id===t);if(r===-1)throw new Error(`Rule with ID ${t} not found`);const i=s.messageTemplate||h[r].messageTemplate,c={...h[r],...s,ctaPreview:s.ctaPreview||i,updatedAt:new Date().toISOString()};return h[r]=c,Promise.resolve(c)},async deleteRule(t){const s=h.findIndex(r=>r.id===t);if(s===-1)throw new Error(`Rule with ID ${t} not found`);return h.splice(s,1),Promise.resolve()},async toggleRuleStatus(t){const s=h.findIndex(i=>i.id===t);if(s===-1)throw new Error(`Rule with ID ${t} not found`);const r={...h[s],status:h[s].status==="Active"?"Inactive":"Active",updatedAt:new Date().toISOString()};return h[s]=r,Promise.resolve(r)},async getRulesAnalytics(){return Promise.resolve(K)},async getRuleAnalytics(t){return Promise.resolve(K.find(s=>s.ruleId===t))},async getOverallStats(){const t=h.filter(p=>p.status==="Active").length,s=h.length-t,r=1247,i=K.reduce((p,l)=>p+l.clicks,0),c=K.reduce((p,l)=>p+l.views,0),o=c>0?i/c*100:0;return Promise.resolve({activeRules:t,inactiveRules:s,jobsProcessed:r,ctaClickRate:o})},async getMarketingAnalytics(){return Promise.resolve(as)}},rs=({onSelectRule:t,onCreateRule:s,onEditRule:r})=>{const{toast:i}=ce(),c=ie(),[o,p]=P.useState(""),[l,f]=P.useState(null),{data:x=[],isLoading:w,isError:E}=se({queryKey:["marketingRules"],queryFn:S.getRules});$({mutationFn:S.toggleRuleStatus,onSuccess:()=>{c.invalidateQueries({queryKey:["marketingRules"]}),i({title:"Status updated",description:"Rule status has been updated successfully."})},onError:d=>{i({title:"Error",description:`Failed to update rule status: ${d instanceof Error?d.message:"Unknown error"}`,variant:"destructive"})}});const a=$({mutationFn:S.deleteRule,onSuccess:()=>{c.invalidateQueries({queryKey:["marketingRules"]}),i({title:"Rule deleted",description:"Marketing rule has been deleted successfully."}),f(null)},onError:d=>{i({title:"Error",description:`Failed to delete rule: ${d instanceof Error?d.message:"Unknown error"}`,variant:"destructive"})}}),g=P.useMemo(()=>{if(!o.trim())return x;const d=o.toLowerCase();return x.filter(A=>A.ruleName.toLowerCase().includes(d)||A.targetLocation.toLowerCase().includes(d)||A.targetJobType.toLowerCase().includes(d)||A.messageTemplate.toLowerCase().includes(d))},[x,o]),M=()=>{l&&a.mutate(l)};return w?e.jsx("div",{className:"text-center py-8",children:"Loading marketing rules..."}):E?e.jsx("div",{className:"text-center py-8 text-destructive",children:"Error loading marketing rules. Please try again."}):e.jsxs(j,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(y,{className:"text-lg font-medium",children:"Marketing Rules List"}),e.jsxs(I,{size:"sm",onClick:s,className:"bg-green-600 hover:bg-green-700",children:[e.jsx(ge,{className:"mr-2 h-4 w-4"})," Create New Rule"]})]}),e.jsx(v,{children:e.jsxs("div",{className:"space-y-4",children:[g.length===0?e.jsx("div",{className:"text-center py-12 border rounded-md bg-muted/20",children:o?"No rules match your search":"No marketing rules found"}):e.jsxs(Ee,{children:[e.jsx(Me,{children:e.jsxs(te,{children:[e.jsx(J,{children:"Rule Name"}),e.jsx(J,{children:"Targeting"}),e.jsx(J,{children:"CTA Preview"}),e.jsx(J,{children:"Status"}),e.jsx(J,{children:"Actions"})]})}),e.jsx(Fe,{children:g.map(d=>e.jsxs(te,{className:"cursor-pointer hover:bg-muted/50",children:[e.jsxs(z,{className:"font-medium",children:[d.ruleName,e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Created ",d.createdAt]})]}),e.jsx(z,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"text-sm",children:["Location: ",d.targetLocation]}),e.jsxs("div",{className:"text-sm",children:["Job Type: ",d.targetJobType]})]})}),e.jsxs(z,{className:"max-w-[200px] truncate",children:['"',d.ctaPreview||d.messageTemplate,'"']}),e.jsx(z,{children:e.jsx(de,{variant:d.status==="Active"?"default":"secondary",children:d.status})}),e.jsx(z,{children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(I,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:()=>r(d),children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsx(I,{variant:"outline",size:"icon",className:"h-8 w-8 text-destructive hover:text-destructive",onClick:()=>f(d.id),children:e.jsx(je,{className:"h-4 w-4"})})]})})]},d.id))})]}),e.jsx(Je,{open:!!l,onOpenChange:d=>!d&&f(null),children:e.jsxs(ze,{children:[e.jsxs(We,{children:[e.jsx(Ve,{children:"Are you sure?"}),e.jsx(Ke,{children:"This action cannot be undone. This will permanently delete the marketing rule."})]}),e.jsxs(Oe,{children:[e.jsx($e,{children:"Cancel"}),e.jsx(qe,{onClick:M,className:"bg-destructive text-destructive-foreground",children:"Delete"})]})]})})]})})]})},ns=({initialData:t,onSubmit:s,onCancel:r})=>{const[i,c]=P.useState((t==null?void 0:t.demographicTags)||[]),[o,p]=P.useState(""),l=Be({resolver:xe(ts),defaultValues:t||{ruleName:"",status:"Inactive",targetLocation:"All",targetJobType:"All",targetDemographics:"",demographicTags:[],messageTemplate:"",ctaLink:"https://www.workwisesa.co.za/",ctaPreview:"",createdAt:new Date().toISOString()}}),f=()=>{if(o.trim()&&!i.includes(o.trim())){const a=[...i,o.trim()];c(a),l.setValue("demographicTags",a),l.setValue("targetDemographics",a.join(", ")),p("")}},x=a=>{const g=i.filter(M=>M!==a);c(g),l.setValue("demographicTags",g),l.setValue("targetDemographics",g.join(", "))},w=a=>{a.key==="Enter"&&(a.preventDefault(),f())},E=a=>{const g={...a,demographicTags:i,targetDemographics:i.join(", "),ctaPreview:a.messageTemplate};s(g)};return e.jsxs(j,{children:[e.jsx(b,{children:e.jsx(y,{children:t?"Edit Marketing Rule":"Create New Marketing Rule"})}),e.jsx(v,{children:e.jsx(he,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(E),className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(R,{control:l.control,name:"ruleName",render:({field:a})=>e.jsxs(C,{children:[e.jsx(T,{children:"Rule Name"}),e.jsx(L,{children:e.jsx(B,{placeholder:"Enter rule name",...a})}),e.jsx(F,{})]})}),e.jsx(R,{control:l.control,name:"status",render:({field:a})=>e.jsxs(C,{className:"flex flex-row items-center justify-between rounded-lg border p-3 shadow-sm",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(T,{children:"Active Status"}),e.jsx(V,{children:"Enable or disable this marketing rule"})]}),e.jsx(L,{children:e.jsx(Ge,{checked:a.value==="Active",onCheckedChange:g=>{a.onChange(g?"Active":"Inactive")}})})]})})]}),e.jsxs(He,{defaultValue:"targeting",children:[e.jsxs(Ue,{className:"grid w-full grid-cols-3",children:[e.jsx(G,{value:"targeting",children:"Targeting"}),e.jsx(G,{value:"content",children:"Content"}),e.jsx(G,{value:"advanced",children:"Advanced"})]}),e.jsxs(H,{value:"targeting",className:"space-y-4 pt-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(R,{control:l.control,name:"targetLocation",render:({field:a})=>e.jsxs(C,{children:[e.jsx(T,{children:"Targeted Location"}),e.jsxs(_,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(L,{children:e.jsx(X,{children:e.jsx(Z,{placeholder:"Select location"})})}),e.jsxs(ee,{children:[e.jsx(n,{value:"All",children:"All Locations"}),e.jsx(n,{value:"Gauteng",children:"Gauteng"}),e.jsx(n,{value:"Western Cape",children:"Western Cape"}),e.jsx(n,{value:"Cape Town",children:"Cape Town"}),e.jsx(n,{value:"Durban",children:"Durban"}),e.jsx(n,{value:"Johannesburg",children:"Johannesburg"}),e.jsx(n,{value:"Pretoria",children:"Pretoria"}),e.jsx(n,{value:"Eastern Cape",children:"Eastern Cape"}),e.jsx(n,{value:"Free State",children:"Free State"}),e.jsx(n,{value:"KwaZulu-Natal",children:"KwaZulu-Natal"}),e.jsx(n,{value:"Limpopo",children:"Limpopo"}),e.jsx(n,{value:"Mpumalanga",children:"Mpumalanga"}),e.jsx(n,{value:"North West",children:"North West"}),e.jsx(n,{value:"Northern Cape",children:"Northern Cape"})]})]}),e.jsx(F,{})]})}),e.jsx(R,{control:l.control,name:"targetJobType",render:({field:a})=>e.jsxs(C,{children:[e.jsx(T,{children:"Targeted Job Type"}),e.jsxs(_,{onValueChange:a.onChange,defaultValue:a.value,children:[e.jsx(L,{children:e.jsx(X,{children:e.jsx(Z,{placeholder:"Select job type"})})}),e.jsxs(ee,{children:[e.jsx(n,{value:"All",children:"All Job Types"}),e.jsx(n,{value:"General Worker",children:"General Worker"}),e.jsx(n,{value:"Construction Worker",children:"Construction Worker"}),e.jsx(n,{value:"Picker/Packer",children:"Picker/Packer"}),e.jsx(n,{value:"Warehouse Assistant",children:"Warehouse Assistant"}),e.jsx(n,{value:"Cashier",children:"Cashier"}),e.jsx(n,{value:"Cleaner",children:"Cleaner"}),e.jsx(n,{value:"Security",children:"Security Guard"}),e.jsx(n,{value:"Admin Clerk",children:"Admin Clerk"}),e.jsx(n,{value:"Retail",children:"Retail"}),e.jsx(n,{value:"IT/Technology",children:"IT/Technology"}),e.jsx(n,{value:"Healthcare",children:"Healthcare"}),e.jsx(n,{value:"Hospitality",children:"Hospitality"}),e.jsx(n,{value:"Manufacturing",children:"Manufacturing"})]})]}),e.jsx(F,{})]})})]}),e.jsxs(C,{children:[e.jsx(T,{children:"Targeted Demographics (Optional)"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:i.map((a,g)=>e.jsxs(de,{variant:"secondary",className:"px-3 py-1",children:[a,e.jsx("button",{type:"button",onClick:()=>x(a),className:"ml-2 text-muted-foreground hover:text-foreground",children:e.jsx(ve,{size:14})})]},g))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(B,{placeholder:"Add demographic (e.g., Entry-level, Graduate)",value:o,onChange:a=>p(a.target.value),onKeyDown:w,className:"flex-1"}),e.jsx(I,{type:"button",variant:"outline",onClick:f,children:"Add"})]}),e.jsx(V,{children:"Enter demographics to target specific groups (press Enter or click Add)"})]})]}),e.jsxs(H,{value:"content",className:"space-y-4 pt-4",children:[e.jsx(R,{control:l.control,name:"messageTemplate",render:({field:a})=>e.jsxs(C,{children:[e.jsx(T,{children:"Message Template (CTA)"}),e.jsx(L,{children:e.jsx(be,{placeholder:"Enter call-to-action message",className:"resize-none min-h-[100px]",...a})}),e.jsx(V,{children:"This message will replace contact information in job listings"}),e.jsx(F,{})]})}),e.jsx(R,{control:l.control,name:"ctaLink",render:({field:a})=>e.jsxs(C,{children:[e.jsx(T,{children:"CTA Link"}),e.jsx(L,{children:e.jsx(B,{placeholder:"https://www.workwisesa.co.za/",...a})}),e.jsx(V,{children:"The URL where users will be directed when clicking the CTA"}),e.jsx(F,{})]})})]}),e.jsx(H,{value:"advanced",className:"space-y-4 pt-4",children:e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Advanced settings coming soon"})})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-4",children:[e.jsx(I,{type:"button",variant:"outline",onClick:r,children:"Cancel"}),e.jsx(I,{type:"submit",className:"bg-green-600 hover:bg-green-700",children:t?"Update Rule":"Create Rule"})]})]})})})]})},ls=({selectedRule:t})=>{if(!t)return null;const s={title:"General Worker",company:"ABC Manufacturing",location:"Johannesburg, Gauteng",jobType:"General Worker",description:"Entry-level position for a general worker. No experience required. Opportunity to learn and grow in a supportive environment.",contactInfo:{email:"jobs@abcmanufacturing.co.za",phone:"011-555-1234",applyInstructions:"Send CV to jobs@abcmanufacturing.co.za or call 011-555-1234"}};return e.jsxs(j,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Marketing Rule Preview"}),e.jsx(N,{children:"See how the rule affects a sample job listing"})]}),e.jsx(v,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(j,{className:"border-2 border-yellow-200",children:[e.jsxs(b,{className:"pb-2 bg-yellow-50",children:[e.jsx(y,{className:"text-base",children:"Original Job Listing"}),e.jsx(N,{children:"Before marketing rule is applied"})]}),e.jsxs(v,{className:"text-sm",children:[e.jsx("h3",{className:"font-bold text-base",children:s.title}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Company:"})," ",s.company]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Location:"})," ",s.location]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Job Type:"})," ",s.jobType]})]}),e.jsx("p",{className:"mt-2",children:s.description}),e.jsxs("div",{className:"mt-4 border-t pt-2 bg-yellow-50 p-2 rounded",children:[e.jsx("p",{className:"font-semibold",children:"Contact Information:"}),e.jsxs("p",{children:["Email: ",s.contactInfo.email]}),e.jsxs("p",{children:["Phone: ",s.contactInfo.phone]}),e.jsx("p",{children:s.contactInfo.applyInstructions})]})]})]}),e.jsxs(j,{className:"border-2 border-green-200",children:[e.jsxs(b,{className:"pb-2 bg-green-50",children:[e.jsx(y,{className:"text-base",children:"After Marketing Rule Applied"}),e.jsx(N,{children:"Contact info replaced with CTA"})]}),e.jsxs(v,{className:"text-sm",children:[e.jsx("h3",{className:"font-bold text-base",children:s.title}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Company:"})," ",s.company]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Location:"})," ",s.location]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Job Type:"})," ",s.jobType]})]}),e.jsx("p",{className:"mt-2",children:s.description}),e.jsxs("div",{className:"mt-4 border-t pt-2 bg-green-50 p-2 rounded",children:[e.jsx("p",{className:"font-semibold",children:"How to Apply:"}),e.jsx("p",{className:"text-blue-600 font-medium hover:text-yellow-600 cursor-pointer",children:t.ctaPreview||t.messageTemplate}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Links to: ",t.ctaLink]})]})]})]})]})})]})},is=()=>{const[t,s]=P.useState("Last 7 Days"),{data:r,isLoading:i,isError:c}=se({queryKey:["marketingRuleAnalytics",t],queryFn:()=>S.getMarketingAnalytics()});if(i)return e.jsx(cs,{});if(c||!r)return e.jsxs(j,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Analytics"}),e.jsx(N,{children:"Performance metrics for marketing rules"})]}),e.jsx(v,{children:e.jsx("div",{className:"text-center py-8 text-destructive",children:"Error loading analytics data. Please try again."})})]});const o=r.performanceByRule.map(x=>({name:x.name.length>15?x.name.substring(0,12)+"...":x.name,clicks:x.clicks})),p=[{name:"Mon",views:1200,clicks:240},{name:"Tue",views:1300,clicks:290},{name:"Wed",views:1400,clicks:350},{name:"Thu",views:1200,clicks:310},{name:"Fri",views:1500,clicks:390},{name:"Sat",views:1100,clicks:250},{name:"Sun",views:1e3,clicks:220}],l=["#0088FE","#00C49F","#FFBB28","#FF8042"],f=[{name:"Views",value:4721},{name:"Clicks",value:1109},{name:"Applications",value:562},{name:"Hires",value:89}];return e.jsxs(j,{children:[e.jsxs(b,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs("div",{children:[e.jsx(y,{className:"text-lg font-medium",children:"Marketing Rule Performance Analytics"}),e.jsx(N,{children:"Performance metrics for all marketing rules"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ye,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs(_,{value:t,onValueChange:s,children:[e.jsx(X,{className:"w-[180px]",children:e.jsx(Z,{placeholder:"Select period"})}),e.jsxs(ee,{children:[e.jsx(n,{value:"Last 7 Days",children:"Last 7 Days"}),e.jsx(n,{value:"Last 30 Days",children:"Last 30 Days"}),e.jsx(n,{value:"Last 90 Days",children:"Last 90 Days"}),e.jsx(n,{value:"Year to Date",children:"Year to Date"})]})]})]})]}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3 lg:grid-cols-3",children:[e.jsx(Y,{title:"Total CTA Views",value:r.totalViews.toLocaleString(),changePercent:r.viewsChangePercent,color:"text-blue-600"}),e.jsx(Y,{title:"Total CTA Clicks",value:r.totalClicks.toLocaleString(),changePercent:r.clicksChangePercent,color:"text-green-600"}),e.jsx(Y,{title:"Click-Through Rate",value:`${r.clickThroughRate.toFixed(1)}%`,changePercent:r.ctrChangePercent,color:"text-purple-600"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(j,{children:[e.jsxs(b,{className:"pb-2",children:[e.jsx(y,{className:"text-base",children:"Daily Performance"}),e.jsx(N,{children:"Views and clicks over time"})]}),e.jsx(v,{children:e.jsx("div",{className:"h-[250px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(Xe,{data:p,margin:{top:5,right:20,left:0,bottom:5},children:[e.jsx(re,{strokeDasharray:"3 3",vertical:!1}),e.jsx(ne,{dataKey:"name",tick:{fontSize:10}}),e.jsx(le,{tick:{fontSize:10}}),e.jsx(Q,{contentStyle:{fontSize:12,padding:"4px 8px"}}),e.jsx(Qe,{}),e.jsx(ae,{type:"monotone",dataKey:"views",stroke:"#8884d8",activeDot:{r:8}}),e.jsx(ae,{type:"monotone",dataKey:"clicks",stroke:"#82ca9d"})]})})})})]}),e.jsxs(j,{children:[e.jsxs(b,{className:"pb-2",children:[e.jsx(y,{className:"text-base",children:"Conversion Funnel"}),e.jsx(N,{children:"From views to hires"})]}),e.jsx(v,{children:e.jsx("div",{className:"h-[250px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(es,{children:[e.jsx(ss,{data:f,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:({name:x,percent:w})=>`${x} ${(w*100).toFixed(0)}%`,children:f.map((x,w)=>e.jsx(Ye,{fill:l[w%l.length]},`cell-${w}`))}),e.jsx(Q,{formatter:x=>x.toLocaleString()})]})})})})]})]}),e.jsxs(j,{children:[e.jsxs(b,{className:"pb-2",children:[e.jsx(y,{className:"text-base",children:"Click Performance by Rule"}),e.jsx(N,{children:"Number of clicks per marketing rule"})]}),e.jsx(v,{children:e.jsx("div",{className:"h-[250px]",children:e.jsx(U,{width:"100%",height:"100%",children:e.jsxs(Ze,{data:o,margin:{top:5,right:0,left:0,bottom:5},children:[e.jsx(re,{strokeDasharray:"3 3",vertical:!1}),e.jsx(ne,{dataKey:"name",tick:{fontSize:10},interval:0}),e.jsx(le,{tick:{fontSize:10}}),e.jsx(Q,{cursor:{fill:"rgba(200,200,200,0.2)"},contentStyle:{fontSize:12,padding:"4px 8px"}}),e.jsx(_e,{dataKey:"clicks",fill:"#8884d8",barSize:30})]})})})})]})]})]})},Y=({title:t,value:s,changePercent:r,description:i,color:c="text-primary"})=>{const o=r<0;return e.jsx(j,{children:e.jsxs(v,{className:"pt-6",children:[e.jsx("div",{className:"text-sm font-medium text-muted-foreground",children:t}),e.jsx("div",{className:`text-2xl font-bold mt-1 ${c}`,children:s}),r!==0&&e.jsxs("div",{className:`text-xs flex items-center mt-1 ${o?"text-red-500":"text-green-500"}`,children:[!o&&e.jsx(fe,{className:"h-3 w-3 mr-1"}),o&&e.jsx(we,{className:"h-3 w-3 mr-1"}),Math.abs(r).toFixed(1),"%",e.jsx("span",{className:"text-muted-foreground ml-1",children:"from last period"})]}),i&&e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:i})]})})},cs=()=>e.jsxs(j,{children:[e.jsxs(b,{children:[e.jsx(y,{children:"Marketing Rule Performance Analytics"}),e.jsx(N,{children:"Loading analytics data..."})]}),e.jsxs(v,{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 grid-cols-1 sm:grid-cols-3 lg:grid-cols-3",children:[e.jsx(D,{className:"h-[100px]"}),e.jsx(D,{className:"h-[100px]"}),e.jsx(D,{className:"h-[100px]"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(D,{className:"h-[300px]"}),e.jsx(D,{className:"h-[300px]"})]}),e.jsx(D,{className:"h-[300px]"})]})]}),os=()=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx(O,{icon:e.jsx(Ne,{className:"h-6 w-6 text-blue-500"}),title:"Job Intake",count:"1,247",description:"Jobs collected from various sources"}),e.jsx(O,{icon:e.jsx(ke,{className:"h-6 w-6 text-indigo-500"}),title:"Rules Applied",count:"3",description:"Active marketing rules"}),e.jsx(O,{icon:e.jsx(oe,{className:"h-6 w-6 text-purple-500"}),title:"CTA Injection",count:"4,721",description:"Total CTA impressions"}),e.jsx(O,{icon:e.jsx(Ce,{className:"h-6 w-6 text-green-500"}),title:"Distribution",count:"23.5%",description:"Average click-through rate"})]}),O=({icon:t,title:s,count:r,description:i})=>e.jsx(j,{className:"border-t-4 border-t-primary",children:e.jsxs(v,{className:"pt-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-sm text-muted-foreground",children:s}),e.jsx("div",{className:"p-2 bg-muted rounded-full",children:t})]}),e.jsx("div",{className:"text-2xl font-bold mb-1",children:r}),e.jsx("p",{className:"text-xs text-muted-foreground",children:i})]})}),ds=()=>{const[t]=ue(),s=r=>t.includes(r);return e.jsx("aside",{className:"fixed left-0 top-0 z-40 h-screen w-64 bg-[#1a2236] text-white",children:e.jsxs("div",{className:"flex h-full flex-col",children:[e.jsx("div",{className:"flex h-16 items-center justify-center border-b border-gray-700",children:e.jsx("h1",{className:"text-xl font-bold",children:"WorkWise SA"})}),e.jsx("nav",{className:"flex-1 overflow-y-auto p-4",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:e.jsxs(k,{to:"/dashboard",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/dashboard")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(Te,{className:"mr-3 h-5 w-5"}),"Dashboard"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/marketing-rules",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/marketing-rules")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(oe,{className:"mr-3 h-5 w-5"}),"Marketing Rules"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/analytics",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/analytics")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(Se,{className:"mr-3 h-5 w-5"}),"Analytics"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/users",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/users")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(Ae,{className:"mr-3 h-5 w-5"}),"Users"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/reports",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/reports")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(Re,{className:"mr-3 h-5 w-5"}),"Reports"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/settings",className:`flex items-center rounded-md px-3 py-2 text-sm ${s("/settings")?"bg-blue-600":"hover:bg-gray-700"}`,children:[e.jsx(Le,{className:"mr-3 h-5 w-5"}),"Settings"]})})]})}),e.jsx("div",{className:"border-t border-gray-700 p-4",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:e.jsxs(k,{to:"/help",className:"flex items-center rounded-md px-3 py-2 text-sm hover:bg-gray-700",children:[e.jsx(De,{className:"mr-3 h-5 w-5"}),"Help & Support"]})}),e.jsx("li",{children:e.jsxs(k,{to:"/",className:"flex items-center rounded-md px-3 py-2 text-sm hover:bg-gray-700",children:[e.jsx(Pe,{className:"mr-3 h-5 w-5"}),"Back to Site"]})}),e.jsx("li",{children:e.jsxs("button",{className:"flex w-full items-center rounded-md px-3 py-2 text-sm hover:bg-gray-700",onClick:()=>console.log("Logout clicked"),children:[e.jsx(Ie,{className:"mr-3 h-5 w-5"}),"Logout"]})})]})})]})})},ms=({children:t})=>e.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[e.jsx(ds,{}),e.jsx("div",{className:"flex-1 ml-64 overflow-auto",children:e.jsx("main",{className:"p-6 max-w-[1200px]",children:t})})]}),Ps=()=>{const{toast:t}=ce(),s=ie(),[r,i]=q.useState("rules"),[c,o]=q.useState(null),[p,l]=q.useState(!1),{data:f,isLoading:x}=se({queryKey:["jobExample",c==null?void 0:c.id],queryFn:()=>{const m={title:"Junior Software Developer",company:"TechInnovate Solutions",location:"Johannesburg, Gauteng",jobType:"IT/Technology",description:"Entry-level position for a passionate developer. Knowledge of HTML, CSS, and JavaScript preferred. Opportunity to learn and grow in a supportive environment.",contactInfo:{email:"recruitment@techinnovate.co.za",phone:"011-555-9876",applyInstructions:"Send CV to jobs@techinnovate.co.za by August 15th"}};return Promise.resolve(m)},enabled:!!c}),w=$({mutationFn:m=>"id"in m?S.updateRule(m.id,m):S.createRule(m),onSuccess:m=>{s.invalidateQueries({queryKey:["marketingRules"]}),t({title:"Success",description:`Marketing rule ${c?"updated":"created"} successfully.`}),o(m),l(!1),i("rules")},onError:m=>{t({title:"Error",description:`Failed to save rule: ${m instanceof Error?m.message:"Unknown error"}`,variant:"destructive"})}});$({mutationFn:S.deleteRule,onSuccess:()=>{s.invalidateQueries({queryKey:["marketingRules"]}),t({title:"Rule deleted",description:"Marketing rule has been deleted successfully."}),o(null)},onError:m=>{t({title:"Error",description:`Failed to delete rule: ${m instanceof Error?m.message:"Unknown error"}`,variant:"destructive"})}});const E=m=>{o(m),l(!1)},a=m=>{var W;o(m),l(!1),(W=document.getElementById("edit-rule-section"))==null||W.scrollIntoView({behavior:"smooth"})},g=()=>{var m;o(null),l(!0),(m=document.getElementById("edit-rule-section"))==null||m.scrollIntoView({behavior:"smooth"})},M=m=>{const W=c?{...c,...m}:m;w.mutate(W)},d=()=>{o(null),l(!1)},A=c||p;return e.jsxs(ms,{children:[e.jsxs(me,{children:[e.jsx("title",{children:"Marketing Rules Manager | WorkWise SA"}),e.jsx("meta",{name:"description",content:"Manage marketing rules for job listings on WorkWise SA"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Marketing Rules Manager"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Create and manage rules to add call-to-action messages to job listings for specific locations and job types."})]}),e.jsx(os,{}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(rs,{onSelectRule:E,onCreateRule:g,onEditRule:a}),A&&e.jsxs("div",{id:"edit-rule-section",className:"space-y-6",children:[e.jsx(ns,{initialData:c||void 0,onSubmit:M,onCancel:d}),e.jsx(ls,{selectedRule:c})]}),e.jsx(is,{})]})]})};export{Ps as default};
